{% extends 'base.html.twig' %}

{% block title %}
    {% if submitted %}
        Resultats
    {% else %}
        Rechercher
    {% endif %}
{% endblock %}
{% block javascripts %}<script src="{{asset('JS/Site.js')}}"></script>{% endblock %}
{% block stylesheets %}<link rel="stylesheet" href="{{asset('CSS/Site.css')}}">{% endblock %}

{% block body %}

    <h1>
        {% if submitted %}
            Resultat pour :
            {% if resultat %}
                {% for clef, valeur in resultat %}
                    {% if clef == "timer" %}
                        Durée Limité
                    {% else %}
                        {{valeur}}
                    {% endif %}
                {% endfor %}
            {% else %}
                Tout les Sites
            {% endif %}
        {% else %}
            Rechercher
        {% endif %}
    </h1>

    <!-- FORM -->
    
        {{ form_start(form) }}
            <select name="departement" class="StyleInput">
                <option value="" selected>Département</option>
                {% set departementArray = [] %}
                {% for site in listeinput %}
                    {% if site.departement not in departementArray %}
                        <option value="{{ site.departement }}">{{ site.departement }}</option>
                        {% set departementArray = departementArray|merge([site.departement]) %}
                    {% endif %}
                {% endfor %}
            </select>
            <select name="commune" class="StyleInput">
                <option value="" selected>Commune</option>
                {% set communeArray = [] %}
                {% for site in listeinput %}
                    {% if site.commune not in communeArray %}
                    <option value="{{ site.commune }}">{{ site.commune }}</option>
                        {% set communeArray = communeArray|merge([site.commune]) %}
                    {% endif %}
                {% endfor %}
            </select>
            <select name="lieuxdit" class="StyleInput">
                <option value="" selected disabled>Lieux-dit</option>
                {% set lieuxDitArray = [] %}
                {% for site in listeinput %}
                    {% if site.lieuxdit not in lieuxDitArray %}
                    <option value="{{ site.lieuxdit }}">{{ site.lieuxdit }}</option>
                        {% set lieuxDitArray = lieuxDitArray|merge([site.lieuxdit]) %}
                    {% endif %}
                {% endfor %}
            </select>
            <select name="interethistorique" class="StyleInput">
                <option value="" selected disabled>Intérêt Historique</option>
                {% set interetHistoriqueArray = [] %}
                {% for site in listeinput %}
                    {% if site.interethistorique not in interetHistoriqueArray %}
                    <option value="{{ site.interethistorique }}">{{ site.interethistorique }}</option>
                        {% set interetHistoriqueArray = interetHistoriqueArray|merge([site.interethistorique]) %}
                    {% endif %}
                {% endfor %}
            </select>
            {{ form_widget(form.timer) }}
            {{ form_label(form.timer) }}
            <button type="submit" class="BoutonsForm">
                <img src="{{asset('IMG/ICONES/RechercherHover.png')}}" alt="recherche" class="IconesFavoris" id="ImgRechercher">
                <img src="{{asset('IMG/ICONES/Rechercher.png')}}" alt="recherche" class="IconesFavoris" id="ImgRechercherHover">
            </button>
        {{ form_end(form) }}
        {% if submitted %}
            <div class="GroupeListeSite">
                {% for site in liste %}
                    <div class="CardSite">
                        <div class={% if site.typetimer %}"TimerBoutonsFavori"{% else %}"BoutonsFavori"{% endif %}>
                            {% if site.typetimer %}
                                <h3 class="Limited">Durée Limité ! Plus que {{site.typetimer}}</h3>
                            {% endif %}
                            <a href="/favori/ajouter/{{site.id}}" class="LiensFavori" id="AjoutFavori">
                                <img src="{{asset('IMG/ICONES/PasFavori.png')}}" alt="ajout aux favoris" class="IconesFavoris" id="CoeurVide">
                                <img src="{{asset('IMG/ICONES/Favori.png')}}" alt="retrait des favoris" class="IconesFavoris" id="CoeurPlein">
                            </a>
                            {# <a href="/favori/supprimer/{{site.id}}" class="LiensFavori Hide" id="SuppressionFavori">
                                <img src="{{asset('IMG/ICONES/PasFavori.png')}}" alt="ajout aux favoris" class="IconesFavoris" id="CoeurVide">
                                <img src="{{asset('IMG/ICONES/Favori.png')}}" alt="retrait des favoris" class="IconesFavoris" id="CoeurPlein">
                            </a> #}
                        </div>
                        <h2>{{site.interethistorique}}</h2>
                        <hr>
                        <div class="JustifierSite">
                            <p>Département : {{site.departement}}</p>
                            <p>Commune : {{site.commune}}</p>
                            <p>Lieux-dit : {{site.lieuxdit}}</p>
                            {# <p>{{site.tempsrestant}}</p> #}
                        </div>
                        <a href="/site/item/{{site.id}}" class="BoutonsEtapes">
                            Voir
                        </a>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
{% endblock %}